#import "@preview/modern-g7-32:0.1.0": gost, abstract, title-templates, structure-heading
#import "@preview/codly:1.3.0": *
#import "@preview/codly-languages:0.1.1": *
#show: codly-init.with()
#show raw: set text(size: 8pt)

#let lab-num = 1

#codly(zebra-fill: none, number-format: none, display-name: false)

#show: gost.with(
  title-template: title-templates.mai-university-lab,
  performers: (
    (name: "Елисеев П.А.", position: "Студент М3О-221Б-23"),
  ),
  institute: (number: 3, name: "Системы управления, информатика и электроэнергетика"),
  department: (number: 311, name: "Прикладные программные средства и математические методы"),
  about: [О лабораторной работе №#str(lab-num)],
  subject: ["МЕТОДЫ ОЦЕНКИ ПОГРЕШНОСТЕЙ"],
  city: "Москва",
  text-size: (default: 13pt, small: 10pt),
  hide-title: true,
)

#set heading(numbering: "1.1.", depth: 2)

#structure-heading[Задание]
1. Число $X = 1.005745$, все цифры которого верны в строгом смысле, округлите до трех значащих цифр. Для полученного числа $X_1 approx X$ найдите предельную абсолютную и предельную относительную погрешности. В записи числа $X_1$ укажите количество верных цифр (в узком и широком смысле).
2. Вычислите с помощью микрокалькулятора значение величины $Z = (a - cos b) / (13c + b)$ при заданных значениях параметров $a = 3.149$, $b = 0.85$, $c = 0.007$, используя «ручные» расчетные таблицы для пошаговой регистрации результатов вычислений, тремя способами:
   1) по правилам подсчета цифр;
   2) по методу строгого учета границ абсолютных погрешностей;
   3) по способу границ.
3. Сравните полученные результаты между собой, прокомментируйте различие методов вычислений и смысл полученных числовых значений.

= Округление числа и оценка погрешностей

Дано число $X = 1.005745$, все цифры которого верны в строгом смысле.
Округлим число $X$ до трех значащих цифр. Первые три значащие цифры: '1', '0', '0'. Следующая цифра '5', поэтому округляем последнюю сохраняемую цифру '0' до '1':
$ X_1 = 1.01 $
Вычислим абсолютную погрешность округления:
$ Delta X_1 = |X - X_1| = |1.005745 - 1.01| = |-0.004255| = 0.004255 $
Определим предельную абсолютную погрешность, округляя $Delta X_1$ с избытком до одной значащей цифры:
$ bar(Delta)X_1 = 0.005 $
Предельная относительная погрешность составляет:
$ delta X_1 = bar(Delta)X_1 / |X_1| = 0.005 / 1.01 approx 0.004950... approx 0.495% $

Укажем количество верных цифр в записи $X_1 = 1.01$ ($bar(Delta)X_1 = 0.005$).
- Цифра '1' (разряд единиц, $h=1$):
  В узком смысле: $bar(Delta)X_1 = 0.005 <= 0.5 * h = 0.5 * 1 = 0.5$. Верна.
  В широком смысле: $bar(Delta)X_1 = 0.005 <= h = 1$. Верна.
- Цифра '0' (разряд десятых, $h=0.1$):
  В узком смысле: $bar(Delta)X_1 = 0.005 <= 0.5 * h = 0.5 * 0.1 = 0.05$. Верна.
  В широком смысле: $bar(Delta)X_1 = 0.005 <= h = 0.1$. Верна.
- Цифра '1' (разряд сотых, $h=0.01$):
  В узком смысле: $bar(Delta)X_1 = 0.005 <= 0.5 * h = 0.5 * 0.01 = 0.005$. Верна.
  В широком смысле: $bar(Delta)X_1 = 0.005 <= h = 0.01$. Верна.
Все три значащие цифры числа $X_1 = 1.01$ являются верными как в узком, так и в широком смысле.

= Вычисление значения Z

Задана величина $Z = (a - cos b) / (13c + b)$ и параметры:
$a = 3.149$
$b = 0.85$ (радианы)
$c = 0.007$

== Вычисление по правилам подсчета цифр (ППЦ)
Промежуточные вычисления ведутся с 1-2 запасными знаками.

1.  $u_0 = cos b = cos(0.85)$. Аргумент $b=0.85$ имеет 2 десятичных знака. Производная $(cos x)' = -sin x$. В точке $x=0.85$, $|-sin(0.85)| approx 0.751 < 1$. Следовательно, $cos(0.85)$ должен иметь 2 верных десятичных знака.
    $cos(0.85) approx 0.659290...$
    С одним запасным знаком: $u_0 approx 0.659$.
2.  $u_1 = a - u_0 = 3.149 - 0.659 = 2.490$.
    (Вычитание: $a$ имеет 3 дес. знака, $u_0$ имеет 3 дес. знака. Результат сохраняет 3 дес. знака).
3.  $u_2 = 13c = 13 * 0.007 = 0.091$.
    ($c=0.007$ имеет 1 значащую цифру '7'. Число 13 точное. Результат должен иметь 1 значащую цифру, но $0.091$ имеет две. По правилу стр.9, п.2: "сохранять столько значащих цифр, сколько их имеет приближенное данное с наименьшим числом значащих цифр". Если $c=0.007$ (1 зн.ц.), то $13c=0.091 -> 0.09$ (1 зн.ц). Сохраним $u_2 = 0.091$ для промежуточных расчетов).
4.  $u_3 = u_2 + b = 0.091 + 0.85 = 0.941$.
    (Сложение: $u_2$ имеет 3 дес. знака, $b$ имеет 2 дес. знака. Результат с 2 дес. знаками $0.94$. Сохраним $u_3 = 0.941$ для промежуточных).
5.  $Z = u_1 / u_3 = 2.490 / 0.941 approx 2.646121...$
    Числитель $u_1=2.490$ (3-4 зн.ц., 3 дес.зн.). Знаменатель $u_3=0.941$ (3 зн.ц., 3 дес.зн.).
    Минимальное число значащих цифр - 3. Округляем результат до 3 значащих цифр:
    $ Z approx 2.65 $

#pagebreak()

#table(
  columns: 5,
  stroke: 0.4pt,
  align: center + horizon,
  [*a*], [*b*], [*c*], [*Операция*], [*Результат (ППЦ)*],
  $3.149$, $0.85$, $0.007$, $u_0 = cos b$, $0.659$,
  $3.149$, $0.85$, $0.007$, $u_1 = a - u_0$, $2.490$,
  $3.149$, $0.85$, $0.007$, $u_2 = 13c$, $0.091$,
  $3.149$, $0.85$, $0.007$, $u_3 = u_2 + b$, $0.941$,
  $3.149$, $0.85$, $0.007$, $Z = u_1 / u_3$, $2.65$
)

== Вычисление по методу строгого учета границ абсолютных погрешностей (СУАП)
Предполагаем, что все цифры в $a, b, c$ верны в узком смысле.
$a = 3.149 => bar(Delta)a = 0.0005$
$b = 0.85 => bar(Delta)b = 0.0005$ (2 знака после запятой)
$c = 0.007 => bar(Delta)c = 0.0005$ (3 знака после запятой)

1.  $u_0 = cos b = cos(0.85) approx 0.65929$
    $bar(Delta)u_0 = |(cos b)'| bar(Delta)b = |-sin b| bar(Delta)b = sin(0.85) * 0.0005 approx 0.75126 * 0.0005 approx 0.00037563$.
    Округляем $bar(Delta)u_0$ с избытком до двух значащих цифр: $bar(Delta)u_0 = 0.00038$.
    $u_0 approx 0.6593$ (один запасной знак относительно погрешности).
2.  $u_1 = a - u_0 = 3.149 - 0.65929 approx 2.48971$
    $bar(Delta)u_1 = bar(Delta)a + bar(Delta)u_0 = 0.0005 + 0.00038 = 0.00088$.
    $u_1 approx 2.4897$ (один запасной знак).
3.  $u_2 = 13c = 13 * 0.007 = 0.091$ (13 - точное)
    $bar(Delta)u_2 = |13| bar(Delta)c = 13 * 0.0005 = 0.0065$.
    $u_2 = 0.0910$ (один запасной знак).
4.  $u_3 = u_2 + b = 0.091 + 0.85 = 0.941$
    $bar(Delta)u_3 = bar(Delta)u_2 + bar(Delta)b = 0.0065 + 0.0005 = 0.0070$.
    $u_3 = 0.941$ (соответствует погрешности).
5.  $Z = u_1 / u_3 = 2.48971 / 0.941 approx 2.6458128...$
    $bar(Delta)Z = (|u_3|bar(Delta)u_1 + |u_1|bar(Delta)u_3) / u_3^2 approx (0.941 * 0.00088 + 2.48971 * 0.0070) / (0.941)^2$
    $bar(Delta)Z approx (0.00082808 + 0.01742797) / 0.885481 = 0.01825605 / 0.885481 approx 0.020617...$
    Округляем $bar(Delta)Z$ с избытком до двух значащих цифр: $bar(Delta)Z = 0.021$.
    Значение $Z approx 2.6458$ округляем так, чтобы последняя цифра была в разряде, соответствующем погрешности (сотые).
    $ Z approx 2.65 $.
    Результат: $Z approx 2.65 plus.minus 0.021$. Верны цифры '2' и '6'.

#pagebreak()

#table(
  columns: 4,
  stroke: 0.4pt,
  align: center + horizon,
  [*Операция*], [*Значение*], [*Погрешность*], [*Результат (СУАП)*],
  [$u_0 = cos b$], $0.65929$, $0.00038$, $0.6593$,
  [$u_1 = a - u_0$], $2.48971$, $0.00088$, $2.4897$,
  [$u_2 = 13c$], $0.09100$, $0.00650$, $0.0910$,
  [$u_3 = u_2 + b$], $0.94100$, $0.00700$, $0.941$,
  [$Z = u_1 / u_3$], $2.64581$, $0.02100$, $2.65$
)

== Вычисление по способу границ (МГ)
$bar(Delta)a = 0.0005 => "НГ_a"=3.1485, "ВГ_a"=3.1495$
$bar(Delta)b = 0.0005 => "НГ_b"=0.8495, "ВГ_b"=0.8505$
$bar(Delta)c = 0.0005 => "НГ_c"=0.0065, "ВГ_c"=0.0075$
Округление нижних границ (НГ) производится по недостатку, верхних (ВГ) – по избытку. Сохраняем 4-5 знаков после запятой для промежуточных вычислений.

1.  $u_0 = cos b$. Функция $cos x$ убывает на $[0, pi/2]$. $0.85 "рад" approx 48.7^o$.
    $"НГ_(u_0)" = cos("ВГ_b") = cos(0.8505) approx 0.658914 -> 0.65891$
    $"ВГ_(u_0)" = cos("НГ_b") = cos(0.8495) approx 0.659666 -> 0.65967$
2.  $u_1 = a - u_0$.
    $"НГ_(u_1)" = "НГ_a" - "ВГ_(u_0)" = 3.1485 - 0.65967 = 2.48883 -> 2.48883$
    $"ВГ_(u_1)" = "ВГ_a" - "НГ_(u_0)" = 3.1495 - 0.65891 = 2.49059 -> 2.49059$
3.  $u_2 = 13c$.
    $"НГ_(u_2)" = 13 * "НГ_c" = 13 * 0.0065 = 0.0845 -> 0.08450$
    $"ВГ_(u_2)" = 13 * "ВГ_c" = 13 * 0.0075 = 0.0975 -> 0.09750$
4.  $u_3 = u_2 + b$.
    $"НГ_(u_3)" = "НГ_(u_2)" + "НГ_b" = 0.08450 + 0.8495 = 0.93400 -> 0.93400$
    $"ВГ_(u_3)" = "ВГ_(u_2)" + "ВГ_b" = 0.09750 + 0.8505 = 0.94800 -> 0.94800$
5.  $Z = u_1 / u_3$. Все значения положительны.
    $"НГ_Z" = "НГ_"(u_1) / "ВГ_"(u_3) = 2.48883 / 0.94800 approx 2.625348... -> 2.62534$    
    $"ВГ_Z" = "ВГ_"(u_1) / "НГ_"(u_3) = 2.49059 / 0.93400 approx 2.666584... -> 2.66659$

Результат: $2.62534 <= Z <= 2.66659$.
Окончательный результат округляем до разряда, где НГ и ВГ начинают расходиться (сотые).
$Z approx (2.62534 + 2.66659) / 2 approx 2.645965$.
$bar(Delta)Z approx (2.66659 - 2.62534) / 2 approx 0.020625$.
Округляем $Z$ до двух десятичных знаков: $Z approx 2.65$.
$bar(Delta)Z$ до трех десятичных знаков: $0.021$.
Результат: $Z approx 2.65 plus.minus 0.021$.

#table(
  columns: 3,
  stroke: 0.4pt,
  align: center + horizon,
  [*Операция*], [*Нижняя граница (НГ)*], [*Верхняя граница (ВГ)*],
  [$a$], $3.14850$, $3.14950$,
  [$b$], $0.84950$, $0.85050$,
  [$c$], $0.00650$, $0.00750$,
  [$u_0 = cos b$], $0.65891$, $0.65967$,
  [$u_1 = a - u_0$], $2.48883$, $2.49059$,
  [$u_2 = 13c$], $0.08450$, $0.09750$,
  [$u_3 = u_2 + b$], $0.93400$, $0.94800$,
  [$Z = u_1 / u_3$], $2.62534$, $2.66659$,
)

= Сравнение результатов и выводы

Результаты вычисления $Z$:
- По правилам подсчета цифр (ППЦ): $Z approx 2.65$.
- По методу строгого учета абсолютных погрешностей (СУАП): $Z approx 2.65 plus.minus 0.021$.
- По методу границ (МГ): $Z approx 2.65 plus.minus 0.021$ (из $2.62534 <= Z <= 2.66659$).

Все три метода дали близкие значения для $Z$.
Метод ППЦ дает только приближенное значение без явной оценки погрешности. Он наиболее прост в применении, но менее точен в оценке надежности результата.
Методы СУАП и МГ предоставляют оценку погрешности ($plus.minus 0.021$), что указывает на то, что достоверно можно утверждать, что значение $Z$ лежит в интервале $[2.629, 2.671]$ (если брать $2.65 plus.minus 0.021$). Интервал, полученный методом границ, $[2.62534, 2.66659]$, является наиболее строгой оценкой.
В данном случае, из-за того, что погрешность $Delta u_2 = Delta(13c)$ достаточно велика по сравнению с $Delta b$, это сильно повлияло на погрешность знаменателя $u_3$, и, как следствие, на погрешность $Z$.
Результаты СУАП и МГ согласуются, давая одинаковую оценку погрешности для $Z$, округленного до двух десятичных знаков. Это говорит о том, что в данном случае оба метода оценки погрешности привели к схожим выводам о точности результата. Надёжными являются цифры $2.6$.